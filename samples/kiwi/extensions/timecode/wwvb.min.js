var wwvb_ph_sync=[0,0,0,1,1,1,0,1,1,0,1,0,0,0];function wwvb_sync(){var t=tc_data.length,c=1;for(i=0;i<14;i++)if(tc_data[t-(14-i)]!=wwvb_ph_sync[i]){c=0;break}if(!c)for(c=2,i=0;i<14;i++)if(tc_data[t-(14-i)]!=(1^wwvb_ph_sync[i])){c=0;break}return c}function wwvb(t){if(tc_trig++,tc_trig>=100&&(tc_trig=0),t==tc_cur?tc_cnt=0:(tc_cnt++,tc_cnt>TC_NOISE_THRESHOLD&&(tc_cur=t,tc_cnt=0,tc_cur&&(tc_phdata^=1))),tc_phdata&&tc_width++,-1==tc_sample_point&&1==tc_phdata_last&&0==tc_phdata&&(tc_dmsg(tc_width.toString()+" "),tc_width>50&&tc_width<110&&(tc_sample_point=tc_trig-Math.round(tc_width/2),tc_sample_point<0&&(tc_sample_point+=100),tc_dmsg("T="+tc_sample_point.toString()+" ")),tc_width=0),tc_sample_point==tc_trig)if(tc_state==tc_st.ACQ_SYNC){if(tc_dmsg(tc_phdata.toString()),tc_data.push(tc_phdata),tc_data.length>=14)tc_inverted=0,2==(c=wwvb_sync())&&(tc_inverted=1),c&&(tc_stat("magenta","Found sync"),tc_dmsg(" SYNC"+(tc_inverted?"-I":"")+"<br>00011101101000 "),tc_dcnt=13,tc_state=tc_st.ACQ_DATA,tc_data=[],tc_min=0);tc_recv++,tc_recv>65+Math.round(20*Math.random())&&(tc_dmsg(" RESTART<br>"),tc_sample_point=-1,tc_width=0,tc_recv=0)}else if(tc_state==tc_st.ACQ_DATA){var c,_=tc_phdata^tc_inverted;if(tc_data.push(_),tc_dmsg(_.toString()),12!=tc_dcnt&&17!=tc_dcnt&&28!=tc_dcnt&&29!=tc_dcnt&&38!=tc_dcnt&&39!=tc_dcnt&&46!=tc_dcnt&&52!=tc_dcnt||tc_dmsg(" "),(18==tc_dcnt||tc_dcnt>=20&&tc_dcnt<=46&&29!=tc_dcnt&&39!=tc_dcnt)&&(tc_min=(tc_min<<1)+_),19==tc_dcnt&&(tc_time0_copy=_),46==tc_dcnt&&(tc_time0=_),tc_data.length>=14&&12==tc_dcnt)(c=wwvb_sync())||(tc_dmsg("RESYNC<br>"),tc_state=tc_st.ACQ_SYNC,tc_sample_point=-1,tc_width=0,tc_recv=0),(1==c&&tc_inverted||2==c&&!tc_inverted)&&(tc_dmsg(" PHASE INVERSION<br>00011101101000 "),tc_inverted^=1);if(58==tc_dcnt){if(tc_min&&tc_time0_copy!=tc_time0)tc_dmsg(" TIME BIT-0 MISMATCH");else if(tc_min){tc_dmsg(" "+tc_min.toString()),console.log("start "+tc_min);var n=tc_min-(tc_MpY+tc_MpD);n++,console.log("2000: "+n);for(var d,i=2001;;){d=0==(3&i);var a=tc_MpY+(d?tc_MpD:0);if(!(n>a))break;n-=a,console.log(i+": "+a+" "+n),i++}console.log("yr done: "+n);for(var e=0;;){var s=tc_dim[e];1==e&&d&&s++;var o=tc_MpD*s;if(console.log(tc_mo[e]+": LY"+d+" "+s),!(n>o))break;n-=o,console.log(tc_mo[e]+": "+o+" "+n),e++}console.log("mo done: "+n+" "+n/24);var r=Math.floor(n/tc_MpD);n-=r*tc_MpD;var m=Math.floor(n/60);n-=60*m,tc_dmsg(" "+(r+1)+" "+tc_mo[e]+" "+i+" "+m.leadingZeros(2)+":"+n.leadingZeros(2)+" UTC"),tc_stat("lime","Time decoded: "+(r+1)+" "+tc_mo[e]+" "+i+" "+m.leadingZeros(2)+":"+n.leadingZeros(2)+" UTC"),10!=n&&40!=n||(tc_sixmin_mode=1)}tc_dmsg("<br>"),tc_data=[],tc_min=0}tc_dcnt++,60==tc_dcnt&&(tc_dcnt=0),0==tc_dcnt&&tc_sixmin_mode&&(tc_sixmin_mode=0,tc_state=tc_st.ACQ_SIXMIN)}else if(tc_state==tc_st.ACQ_SIXMIN){0==tc_dcnt&&tc_dmsg("127b: "),127==tc_dcnt&&tc_dmsg("<br>106b: "),233==tc_dcnt&&tc_dmsg("<br>127b: ");_=tc_phdata^tc_inverted;tc_dmsg(_.toString()),tc_dcnt++,360==tc_dcnt&&(tc_dmsg("<br>"),tc_dcnt=0,tc_state=tc_st.ACQ_DATA)}tc_phdata_last=tc_phdata}