var colormap_ext_name="colormap",colormap_first_time=!0;function colormap_main(){ext_switch_to_client(colormap_ext_name,colormap_first_time,colormap_recv),colormap_first_time||colormap_controls_setup(),colormap_first_time=!1}function colormap_recv(o){if("DAT"!=arrayBufferToStringLen(o,3))for(var a=arrayBufferToString(o).substring(4).split(" "),l=0;l<a.length;l++){var e=a[l].split("=");switch(e[0]){case"ready":colormap_controls_setup();break;default:console.log("colormap_recv: UNKNOWN CMD "+e[0])}}else{var t=new Uint8Array(o,4),c=t[0],r=t.length-1;console.log("colormap_recv: DATA UNKNOWN cmd="+c+" len="+r)}}function colormap_plot(){var o=colormap.canvas.ctx;o.fillStyle="mediumBlue",o.fillRect(0,0,256,256);for(var a=0;a<255;a++){var l,e=1-a/255,t=e;(l=Math.exp(colormap.ef*e)*a)<0&&(l=0),l>255&&(l=255),o.fillStyle="white",l=a+a*(1-Math.exp(colormap.ef*t)),200==a&&console.log("xn="+t+" eff="+colormap.ef*t+"|"+Math.exp(colormap.ef*t)+" x="+l),l<0&&(l=0),l>255&&(l=255),o.fillStyle="lime",o.fillRect(l,255-a,1,1),o.fillStyle="yellow",o.fillRect(a,255-a,1,1)}}var colormap={canvas:0,imageData:0,ef:0};function colormap_controls_setup(){var o=w3_div("id-colormap-data|left:0px; width:256px; height:256px; background-color:mediumBlue; overflow:hidden; position:relative;",'<canvas id="id-colormap-canvas" width="256" height="256" style="position:absolute"></canvas>'),a=w3_div("id-colormap-controls w3-text-white",w3_half("","",o,w3_divs("w3-container/w3-tspace-8",w3_div("w3-medium w3-text-aqua","<b>Colormap definition</b>"),w3_slider("","Exp","colormap.ef",colormap.ef,-10,10,.1,"colormap_exp_cb"),w3_input("id-colormap-input1||size=10"))));ext_panel_show(a,null,null),ext_set_controls_width_height(null,330),colormap.canvas=w3_el("id-colormap-canvas"),colormap.canvas.ctx=colormap.canvas.getContext("2d"),colormap.canvas.imageData=colormap.canvas.ctx.createImageData(256,1),colormap_plot()}function colormap_exp_cb(o,a){a=+a,w3_num_cb(o,a),w3_set_label("Exp "+a.toFixed(2),o),colormap.ef=a,colormap_plot()}