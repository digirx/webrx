var lms_ext_name="LMS_filter",lms_first_time=!0;function LMS_filter_main(){ext_switch_to_client(lms_ext_name,lms_first_time,lms_recv),lms_first_time||lms_controls_setup(),lms_first_time=!1}function lms_recv(e){if("DAT"!=arrayBufferToStringLen(e,3))for(var s=arrayBufferToString(e).substring(4).split(" "),_=0;_<s.length;_++){var l=s[_].split("=");switch(l[0]){case"ready":lms_controls_setup();break;default:console.log("lms_recv: UNKNOWN CMD "+l[0])}}else{var t=new Uint8Array(e,4),n=t[0],a=t.length-1;console.log("lms_recv: DATA UNKNOWN cmd="+n+" len="+a)}}function lms_controls_setup(){var e=w3_div("id-lms-controls w3-text-white",w3_divs("w3-container/w3-tspace-8",w3_div("w3-medium w3-text-aqua","<b>LMS filter controls</b>"),w3_inline("w3-margin-between-16",w3_checkbox("w3-label-inline w3-text-css-orange/","Denoiser","lms.denoise2",lms.denoise,"lms_denoise2_cb"),w3_button("w3-padding-smaller","SSB #1","lms_de_presets_cb",0),w3_button("w3-padding-smaller","SSB #2","lms_de_presets_cb",1)),w3_div("w3-section",w3_slider("","Delay line","lms.de_delay",lms.de_delay,1,200,1,"lms_delay_cb"),w3_slider("","Beta","lms.de_beta",lms.de_beta,1e-4,.15,1e-4,"lms_beta_cb"),w3_slider("","Decay","lms.de_decay",lms.de_decay,.9,1,1e-4,"lms_decay_cb")),w3_inline("w3-margin-between-16",w3_checkbox("w3-label-inline w3-text-css-orange/","Autonotch","lms.autonotch2",lms.autonotch,"lms_autonotch2_cb"),w3_button("w3-padding-smaller","Voice","lms_an_presets_cb",0),w3_button("w3-padding-smaller","Slow CW","lms_an_presets_cb",1),w3_button("w3-padding-smaller","Fast CW","lms_an_presets_cb",2)),w3_div("w3-section",w3_slider("","Delay line","lms.an_delay",lms.an_delay,1,200,1,"lms_delay_cb"),w3_slider("","Beta","lms.an_beta",lms.an_beta,1e-4,.15,1e-4,"lms_beta_cb"),w3_slider("","Decay","lms.an_decay",lms.an_decay,.9,1,1e-4,"lms_decay_cb"))));ext_panel_show(e,null,null),ext_set_controls_width_height(400,400)}var lms={denoise:0,denoise2:0,de_delay:1,de_beta:.05,de_decay:.98,autonotch:0,autonotch2:0,an_delay:48,an_beta:.125,an_decay:.99915};function lms_presets_menu_cb(){}var lms_de_presets=[1,.05,.98,100,.07,.985];function lms_de_presets_cb(e,s,_){var l=lms_de_presets;w3_slider_set("lms.de_delay",l[3*s],"lms_delay_cb"),w3_slider_set("lms.de_beta",l[3*s+1],"lms_beta_cb"),w3_slider_set("lms.de_decay",l[3*s+2],"lms_decay_cb")}var lms_an_presets=[48,.125,.99915,48,.002,.9998,48,.001,.998];function lms_an_presets_cb(e,s,_){var l=lms_an_presets;w3_slider_set("lms.an_delay",l[3*s],"lms_delay_cb"),w3_slider_set("lms.an_beta",l[3*s+1],"lms_beta_cb"),w3_slider_set("lms.an_decay",l[3*s+2],"lms_decay_cb")}function lms_delay_cb(e,s,_,l){s=+s,w3_num_cb(e,s),w3_set_label("Delay line: "+s+" samp"+(1==s?"":"s")+", "+(1*s/12e3*1e3).toFixed(3)+" msec",e),_&&snd_send("SET "+e+"="+s)}function lms_beta_cb(e,s,_,l){s=+s,w3_num_cb(e,s),w3_set_label("Beta: "+s.toFixed(4),e),_&&snd_send("SET "+e+"="+s)}function lms_decay_cb(e,s,_,l){s=+s,w3_num_cb(e,s),w3_set_label("Decay: "+s.toFixed(4),e),_&&snd_send("SET "+e+"="+s)}function lms_denoise_cb(e,s,_){s=s?1:0,lms.denoise=s,w3_checkbox_set(e,s),w3_checkbox_set("lms.denoise2",s),snd_send("SET lms_denoise="+s)}function lms_denoise2_cb(e,s,_){s=s?1:0,lms.denoise=lms.denoise2=s,w3_checkbox_set(e,s),w3_checkbox_set("lms.denoise",s),snd_send("SET lms_denoise="+s)}function lms_autonotch_cb(e,s,_){s=s?1:0,lms.autonotch=s,w3_checkbox_set(e,s),w3_checkbox_set("lms.autonotch2",s),snd_send("SET lms_autonotch="+s)}function lms_autonotch2_cb(e,s,_){s=s?1:0,lms.autonotch=lms.autonotch2=s,w3_checkbox_set(e,s),w3_checkbox_set("lms.autonotch",s),snd_send("SET lms_autonotch="+s)}